This repo contains the scripts used for docs previews in pull requests across
OpenZeppelin projects.

### How to use

Add a dev dependency on this repo.

```
npm install --save-dev github:OpenZeppelin/docs-preview-script
yarn add --dev github:OpenZeppelin/docs-preview-script
```

Use the `oz-docs` executable in the package's scripts. You need to provide the
`-c` option with a path to the Antora component that you want to render (this
is the directory that contains the `antora.yml` file).

You should add two commands: `docs` and `docs:watch`. The latter should use the
`oz-docs watch [PATTERN...]` command. If some of the docs are generated by a
`prepare-docs` command, e.g., extracting them from Solidity or JavaScript
files, you should specifiy glob patterns that match the source files so that
the docs are regenerated automatically.

```diff
   "scripts": {
+    "docs": "oz-docs -c docs",
+    "docs:watch": "npm run docs watch contracts",
     "prepare-docs": "solidity-docgen -i contracts -o docs"
   },
```

The above should enable local previews of the docs. It's also useful to set up
docs previews on pull requests. This is done using Netlify Deploy Previews.

Create a `netlify.toml` file at the root of the repo with the following contents.
(The command and the path may be slightly different for monorepos or repos using
yarn.)

```toml
[build]
command = "npm run docs"
publish = "build/site"
```

Then create a Netlify site connected to the repository. Deploy Previews for the
`master` branch are enabled by default.

### Initializing docs on a new repo

This package also provides the `oz-docs init` command, which will create the
necessary directories and files to include use a repo in the docs site.
